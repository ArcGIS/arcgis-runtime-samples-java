//[DocRef: Name=Use_Cloud_And_Servers-Share_Portal_Item-Share_Group

    final ListenableFuture&lt;List&lt;PortalGroup&gt;&gt; shareFuture = portalItemToShare.shareWithGroupsAsync(shareWithGroups);
    shareFuture.addDoneListener(new Runnable() {
      @Override
      public void run() {
        try {
          // Get a list of any portal groups which the item failed to be shared into.
          List&lt;PortalGroup&gt; failedGroups = shareFuture.get();
          if ((failedGroups != null) &amp;&amp; (failedGroups.size() &gt; 0) ) {
            showMessage("Sharing failed for " + failedGroups.size() + " of the groups:");
          }
          else {
            showMessage(String.format("Item shared into %d groups", shareWithGroups.size()));
          }
        } catch (InterruptedException | ExecutionException e) {
          dealWithException(e);
        }
      }
    });
//[DocRef: Name=Use_Cloud_And_Servers-Share_Portal_Item-Share_Group